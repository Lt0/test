---


---

<h1 id="description">Description</h1>
<p>This document introduce how to create a simple vEPC on a single server for functional test.</p>
<br>
Here is the service topology on the single machine:
<br>
![enter image description here](https://woniuxiang.space/api/file/getImage?fileId=5bef35aa688562000c261c35)
<ul>
<li>virbr0 is a linux bridge created when you install packages about libvirt</li>
<li>All service traffic go through br0</li>
<li>We can mange all VMs via iDRAC and virbr0, you can also login VMs via br0 once service is up in it.</li>
</ul>
<br>
<br>
# Setup Host 
## Install OS
Installing ubuntu 14.04 or ubuntu 16.04 on baremetal firstly.
<br>
## Install packages
Installing all required packages:
```
sudo apt-get update
sudo apt-get -y install qemu-kvm libvirt-bin virtinst bridge-utils virt-viewer libguestfs-tools uml-utilities virt-manager
```
<br>
## Setup network
Configuring br0 in /etc/network/interfaces, below is an example configuration:
<pre><code>auto lo
iface lo inet loopback

# The primary network interface
auto em1
iface em1 inet manual
		
# bridge interfaces
auto br0
iface br0 inet static
  address 192.168.97.19
  netmask 255.255.255.0
  gateway 192.168.97.1
  dns-nameservers 172.25.25.5
  bridge_ports em1
  bridge_stp off
  bridge_fd 0
  bridge_maxwait 0

# Add route for UE
# 60.10.5.0/24 is UEs network
# 192.168.97.22 is service IP on SAEGW-U  
post-up route add -net 60.10.5.0 netmask 255.255.255.0 gw 192.168.97.22 dev br0

# restore iptables rules
pre-up iptables-restore &lt; /etc/iptables-rules
</code></pre>
<br>
## Setup iptables
Creating /etc/iptables:
```
# Generated by iptables-save v1.4.21 on Sat Nov 10 14:46:02 2018
*nat
:PREROUTING ACCEPT [3209:332417]
:INPUT ACCEPT [261:46664]
:OUTPUT ACCEPT [12:768]
:POSTROUTING ACCEPT [243:14718]
-A POSTROUTING -s 60.10.5.0/24 -j SNAT --to-source 192.168.97.19
COMMIT
# Completed on Sat Nov 10 14:46:02 2018
# Generated by iptables-save v1.4.21 on Sat Nov 10 14:46:02 2018
*mangle
:PREROUTING ACCEPT [3576904:3596936246]
:INPUT ACCEPT [3415096:3576677876]
:FORWARD ACCEPT [30012:6141668]
:OUTPUT ACCEPT [3404681:3560649894]
:POSTROUTING ACCEPT [3434688:3566791090]
-A POSTROUTING -o virbr0 -p udp -m udp --dport 68 -j CHECKSUM --checksum-fill
COMMIT
# Completed on Sat Nov 10 14:46:02 2018
# Generated by iptables-save v1.4.21 on Sat Nov 10 14:46:02 2018
*filter
:INPUT ACCEPT [14839:1312615]
:FORWARD ACCEPT [17479:5174509]
:OUTPUT ACCEPT [12703:1415972]
COMMIT
# Completed on Sat Nov 10 14:46:02 2018
```
<br>
**Note**
192.168.97.19 in the file is Host service IP on br0, you need to change it to your service IP on br0.
<br>
## Create VMs
You can create VMs from exist qcow2 or ISO. Do not use casa-mobile-xxx.qcow2 becuase these qcow2 were created for openstack environment and there are some scripts controlled by VMC will change inner configuration.
<br>
### Preparing ISO for creating VM:
<ul>
<li>/var/lib/libvirt/images/casa-axyom-4.9.3-525.iso</li>
<li>/var/lib/libvirt/images/casa-axyom-4.9.5-64.iso</li>
<li>/var/lib/libvirt/images/ubuntu-14.04.5-server-amd64.iso</li>
</ul>
<br>
### setup X11
Make sure DISPLAY were set on Host
```
sed -i 's/^#DISPLAY/DISPLAY/g' /etc/security/pam_env.conf
sed -i 's/^#REMOTEHOST/REMOTEHOST/g' /etc/security/pam_env.conf
```
<br>
**Note**
You need to relogin to take effect.
<br>
### start X11 server
Start a X11 server on your windows like xming or any others.
<br>
### Creating VM for MME:
```
virt-install -n mme -r 16382 -c /var/lib/libvirt/images/casa-axyom-4.9.3-525.iso --vcpus 12 --cpu Haswell,-rtm,-hle,+rdrand,+f16c --disk path=/var/lib/libvirt/images/mme.qcow2,size=200,format=qcow2 --network bridge=virbr0,model=virtio --network bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 
```
<br>
### Creating VM for SAEGW-C
```
virt-install -n saegw-c -r 16382 -c /var/lib/libvirt/images/casa-axyom-4.9.5-64.iso --vcpus 12 --cpu Haswell,-rtm,-hle,+rdrand,+f16c --disk path=/var/lib/libvirt/images/saegw-c.qcow2,size=200,format=qcow2 --network bridge=virbr0,model=virtio --network bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 
```
<br>
### Creating VM for SAEGW-U
```
virt-install -n saegw-u -r 16382 -c /var/lib/libvirt/images/casa-axyom-4.9.5-64.iso --vcpus 12 --cpu Haswell,-rtm,-hle,+rdrand,+f16c --disk path=/var/lib/libvirt/images/saegw-u.qcow2,size=200,format=qcow2 --network bridge=virbr0,model=virtio --network bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 
```
<br>
### Creating VM for HSS
```
virt-install -n hss -r 4096 -c /var/lib/libvirt/images/ubuntu-14.04.5-server-amd64.iso --vcpus 12 --cpu Haswell,-rtm,-hle,+rdrand,+f16c --disk path=/var/lib/libvirt/images/saegw-u.qcow2,size=200,format=qcow2 --network bridge=virbr0,model=virtio --network bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 
```
<br>
# Setup MME 
The MME VM will auto start once installation finish, and you need to stop casa-mobile service once you can access VM's console.
```
stop casa-mobile
```
<br>
## cpu.conf
Creating /etc/virtcasa.d/cpu.conf:
```

    
        
        
        
        
        
        
        
<pre><code>    &lt;task name="ffe"      instances="1" mem="2048" /&gt;
    &lt;task name="connmgr"  instances="1" mem="512" /&gt;
    &lt;task name="s1mmemgr" instances="1" mem="512" /&gt;
    &lt;task name="mepmgr"   instances="1" mem="512" /&gt;
    &lt;task name="aaamgr"   instances="1" mem="512" /&gt;
&lt;/software&gt;
</code></pre>

```
<br>
## hugepages
Configuring /etc/default/casa, HUGEPAGES here need to be changed to 4096.
```
...
# Number of 2-MB hugepages to reserve
HUGEPAGES=4096
...
```
<br>
## startup-config
Creating /fdsk/startup-config, below is an example configuration, you need to change the gige 0/1 IP to your MME service port IP.
```
!
!User account/session configuration
!
! CASA-MOBILE system running configuration 
!
<p>!casa logging control configuration:<br>
!<br>
!syslog servers for non-DOCSIS events:</p>
<p>hostname “Casa-MME0”<br>
!<br>
!<br>
password encrypted R7VgbZPass.y4yDukYdA8/</p>
<p>!<br>
aaa authentication login local<br>
aaa accounting default group tacacsplus<br>
!<br>
interface gige 0/0<br>
auto negotiate<br>
no shutdown</p>
<p>interface gige 0/1<br>
ip address 192.168.97.20  255.255.255.0<br>
auto negotiate<br>
no shutdown</p>
<p>interface loopback 1<br>
description “s1-mme interface to SeGW/eNB”<br>
ip address 110.1.1.123 255.255.255.255</p>
<p>interface loopback 2<br>
description “s11 interface to SAEGW-C”<br>
ip address 120.1.1.123 255.255.255.255</p>
<p>interface loopback 3<br>
description “s6a interface to HSS”<br>
ip address 130.1.1.123 255.255.255.255</p>
<p>license<br>
exit<br>
!</p>
<p>! static arp</p>
<p>ip route 0.0.0.0/0 192.168.97.1 1<br>
ip route 10.130.0.228/32 192.168.97.1 1<br>
ip route 20.60.0.0/16 192.168.97.252 1<br>
ip route 21.21.22.1/32 192.168.97.21 1<br>
ip route 21.21.22.3/32 192.168.97.21 1<br>
ip route 198.0.133.59/32 192.168.97.1 1<br>
!<br>
!snmp agent configuration<br>
!<br>
!DNS service configuration<br>
!<br>
nms-agent</p>
<p>diameter-endpoint hss<br>
origin host Casa-MME-10 realm <a href="http://epc.mnc001.mcc001.3gppnetwork.org">epc.mnc001.mcc001.3gppnetwork.org</a> gige 0/1<br>
peer host <a href="http://hss.casa.com">hss.casa.com</a> realm <a href="http://casa.com">casa.com</a> ipv4 192.168.97.24 sctp<br>
route-entry realm <a href="http://casa.com">casa.com</a> app s6a peer host <a href="http://hss.casa.com">hss.casa.com</a> weight 100<br>
watch-dog timer 100<br>
peer-reconnect timer 10<br>
exit</p>
<p>apn-profile profile1<br>
apn-name mec partial-match preference 2<br>
pgw 21.21.22.3<br>
ue-mapped-usage-type 1<br>
exit<br>
apn-name internet partial-match preference 1<br>
pgw 21.21.22.3<br>
ue-mapped-usage-type 2<br>
exit<br>
exit<br>
lte-service mme<br>
call-profile 1<br>
guti-reallocation-interval 300<br>
attach validate-identity query-type imei<br>
tau validate-identity query-type imei<br>
dual-address-bearer-support off<br>
integrity-algorithm preference EIA0 EIA1 EIA2<br>
ciphering-algorithm preference EEA0 EEA1 EEA2<br>
exit<br>
mme-service casa-mme<br>
mme-plmn-id mcc 901 mnc 70 group-id 1 mme-code 1<br>
mme-relative-capacity 128<br>
s1mme-interface gige 0/1 sctp-port 36412<br>
s10-interface loopback 2<br>
s11-interface loopback 2<br>
s6a-interface diameter-endpoint hss destination-realm <a href="http://casa.com">casa.com</a><br>
associate apn-profile  profile1<br>
associate call-profile 1<br>
default-pgw 21.21.22.3<br>
default-sgw 21.21.22.1<br>
exit</p>
<p>dhcpmgr fingerprint profile</p>
<p>!end of configuration</p>
<pre><code>
&lt;br&gt;
## /etc/network/interfaces
Configuring eth0 in /etc/network/interfaces as below:
</code></pre>
<h1 id="this-file-describes-the-network-interfaces-available-on-your-system">This file describes the network interfaces available on your system</h1>
<h1 id="and-how-to-activate-them.-for-more-information-see-interfaces5.">and how to activate them. For more information, see interfaces(5).</h1>
<h1 id="the-loopback-network-interface">The loopback network interface</h1>
<p>auto lo<br>
iface lo inet loopback</p>
<p>auto eth0<br>
iface eth0 inet static<br>
address 192.168.122.2<br>
netmask 255.255.255.0<br>
dns-nameservers 8.8.8.8</p>
<pre><code>
&lt;br&gt;
## reboot
reboot the VM:
</code></pre>
<p>reboot</p>
<pre><code>
&lt;br&gt;
# Setup SAEGW-C 
The SAEGW-C VM will auto start once installation finish, and you need to stop casa-mobile service once you can access VM's console.
</code></pre>
<p>stop casa-mobile</p>
<pre><code>
&lt;br&gt;
## cpu.conf
Creating /etc/virtcasa.d/cpu.conf:
</code></pre>

    
        
        
         
        
        
        
        
    

```
<br>
## hugepages
Configuring /etc/default/casa, HUGEPAGES here need to be changed to 4096.
```
...
# Number of 2-MB hugepages to reserve
HUGEPAGES=4096
...
```
<br>
## startup-config
Creating /fdsk/startup-config, below is an example configuration, you need to change the gige 0/1 IP to your SAEGW-C service port IP.
```
!User account/session configuration
<p>! CASA-MOBILE system running configuration</p>
<p>!casa logging control configuration:<br>
!<br>
!syslog servers for non-DOCSIS events:</p>
<p>hostname “Casa-SAEGW-C”<br>
!<br>
!<br>
password encrypted R7VgbZPass.y4yDukYdA8/<br>
!<br>
aaa authentication login local<br>
aaa accounting default group tacacsplus<br>
!<br>
interface gige 0/0<br>
auto negotiate<br>
no shutdown</p>
<p>interface gige 0/1<br>
ip address 192.168.97.21  255.255.255.0<br>
auto negotiate<br>
no shutdown</p>
<p>!<br>
interface loopback 1<br>
description “S4S11-interface SGW-C to MME”<br>
ip address 21.21.22.1 255.255.255.255</p>
<p>interface loopback 2<br>
description “S5S8-interface SGW-C to PGW-C”<br>
ip address 21.21.22.2 255.255.255.255</p>
<p>interface loopback 3<br>
description “S5S8-interface PGW-C to SGW-C”<br>
ip address 21.21.22.3 255.255.255.255</p>
<p>interface loopback 8<br>
description “Sxa-interface SGW-C to SAEGW-U”<br>
ip address 22.22.23.1 255.255.255.255</p>
<p>interface loopback 9<br>
description “Sxb-interface PGW-C to SAEGW-U”<br>
ip address 22.22.23.2 255.255.255.255</p>
<p>interface loopback 12<br>
description “Gx-interface PGW-C to PCRF”<br>
ip address 24.24.25.1 255.255.255.255<br>
!<br>
license<br>
exit<br>
!<br>
! static arp</p>
<p>ip route 0.0.0.0/0 192.168.97.1 1<br>
ip route 0.0.0.0/0 192.168.100.1 1<br>
ip route 20.60.0.0/16 192.168.97.252 1<br>
ip route 32.32.2.1/32 192.168.100.126 1<br>
ip route 32.32.2.2/32 192.168.100.126 1<br>
ip route 32.32.3.1/32 192.168.100.127 1<br>
ip route 32.32.3.2/32 192.168.100.127 1<br>
ip route 32.32.32.1/32 192.168.97.22 1<br>
ip route 32.32.32.2/32 192.168.97.22 1<br>
ip route 120.1.1.123/32 192.168.97.20 1<br>
!<br>
!snmp agent configuration<br>
!<br>
!DNS service configuration<br>
!</p>
<p>!DPI service configuration<br>
!<br>
nms-agent</p>
<p>diameter-endpoint Gx-Casa-Connection-2<br>
watch-dog timer 60<br>
exit<br>
diameter-endpoint Gx-Casa-Connection-1<br>
watch-dog timer 30<br>
exit<br>
diameter-endpoint Gx-Casa-Connection-nn01<br>
watch-dog timer 30<br>
exit<br>
gx-service  casa-pgw-gx-service-nn01<br>
diameter-endpoint Gx-Casa-Connection-nn01<br>
fault-handling init-req continue<br>
destination realm <a href="http://netnumber.com">netnumber.com</a><br>
dictionary standard<br>
time-out fault-handling 12<br>
exit<br>
gx-service  casa-pgw-gx-service-1<br>
diameter-endpoint Gx-Casa-Connection-1<br>
fault-handling init-req continue<br>
destination realm <a href="http://gxserver.openet.com">gxserver.openet.com</a><br>
dictionary standard<br>
time-out fault-handling 12<br>
exit<br>
gx-service  casa-pgw-gx-service-2<br>
diameter-endpoint Gx-Casa-Connection-2<br>
fault-handling init-req continue<br>
destination realm <a href="http://GxB90.com">GxB90.com</a><br>
dictionary standard<br>
time-out fault-handling 12<br>
exit<br>
!<br>
pcc-action actionApn1-Dedicated-Bearer-QCI-1<br>
qos uplink mbr 31000 gbr 31000<br>
qos downlink mbr 31000 gbr 31000<br>
qci 1 arp pl 7 pci 1 pvi 1</p>
<p>pcc-action actionApn1-Dedicated-Bearer-QCI-7<br>
qci 7 arp pl 7 pci 0 pvi 0</p>
<p>pcc-action action-nat<br>
forwarding-policy cgnat</p>
<p>pcc-action actionApn2-Dedicated-Bearer-QCI-4<br>
qos uplink mbr 310000 gbr 310000<br>
qos downlink mbr 310000 gbr 310000<br>
qci 4 arp pl 10 pci 1 pvi 1</p>
<p>pcc-action actionApn1-Default-Bearer-QCI-5<br>
qos uplink mbr 0 gbr 0<br>
qos downlink mbr 0 gbr 0<br>
qci 5 arp pl 1 pci 0 pvi 0<br>
content-id 210<br>
rating-group 100<br>
online disable<br>
offline enable<br>
monitoring-key disable</p>
<p>pcc-action actionApn1-Dedicated-Bearer-QCI-2<br>
qos uplink mbr 31000 gbr 31000<br>
qos downlink mbr 31000 gbr 31000<br>
qci 1 arp pl 2 pci 0 pvi 0<br>
!<br>
pkt-filter filter1Apn1-QCI-1-Any<br>
direction bidirectional<br>
protocol any<br>
remote-addr ipv4 10.10.202.248/32</p>
<p>pkt-filter catchall<br>
direction bidirectional<br>
protocol any<br>
remote-addr any</p>
<p>pkt-filter lbo-any<br>
direction bidirectional<br>
protocol any</p>
<p>pkt-filter filter1Apn2-QCI-4-Any<br>
direction bidirectional<br>
protocol any<br>
remote-addr ipv4 10.10.202.248/32</p>
<p>pkt-filter filter1Apn1-QCI-2-UDP-v4<br>
direction bidirectional<br>
protocol 17<br>
remote-addr ipv4 192.168.167.212/32</p>
<p>pkt-filter lbo-destination<br>
direction bidirectional<br>
protocol any<br>
remote-addr ipv4 192.168.102.111/32</p>
<p>pkt-filter filter1Apn1-QCI-7-Any<br>
direction bidirectional<br>
protocol any<br>
remote-addr ipv4 10.10.202.248/32</p>
<p>pkt-filter filter2Apn1-QCI-2-UDP-v4<br>
direction bidirectional<br>
protocol 17<br>
remote-addr ipv4 192.168.167.84/32</p>
<p>pkt-filter lbo-tcp<br>
direction bidirectional<br>
protocol 6<br>
pkt-remote-port 80<br>
!<br>
pcc-rulebase rulebaseApn1<br>
pcc-rule APN1-QCI-2-1 priority 1 pkt-filter filter1Apn1-QCI-2-UDP-v4 pcc-action actionApn1-Dedicated-Bearer-QCI-2<br>
pcc-rule APN1-QCI-2-2 priority 2 pkt-filter filter2Apn1-QCI-2-UDP-v4 pcc-action actionApn1-Dedicated-Bearer-QCI-2</p>
<p>pcc-rulebase StandardDataUsage<br>
pcc-rule APN2-QCI-4 priority 4 pkt-filter filter1Apn2-QCI-4-Any pcc-action actionApn2-Dedicated-Bearer-QCI-4</p>
<p>pcc-rulebase IMS<br>
pcc-rule APN1-QCI-1 priority 3 pkt-filter filter1Apn1-QCI-1-Any pcc-action actionApn1-Dedicated-Bearer-QCI-1</p>
<p>pcc-rulebase lbo-rule<br>
pcc-rule lbo priority 1 pkt-filter lbo-any pcc-action action-nat</p>
<p>pcc-rulebase INTERNET</p>
<p>pcc-rulebase IMS2<br>
pcc-rule APN1-QCI-7-1 priority 3 pkt-filter filter1Apn1-QCI-7-Any pcc-action actionApn1-Dedicated-Bearer-QCI-7<br>
!<br>
!NSF service configuration<br>
!<br>
lte-service pgw-c<br>
charging-character 0x0002<br>
charging-condition-limit 3<br>
duration-limit session 3600<br>
volume-limit session 50000000<br>
serving-node-limit 2<br>
charging-method online<br>
exit<br>
charging-character 0x0001<br>
charging-condition-limit 3<br>
interim 60<br>
serving-node-limit 4<br>
cc-rating-group 100<br>
charging-method offline<br>
exit</p>
<p>cc-profile profile2 home 0x0002<br>
cc-profile profile1 home 0x0001</p>
<p>apn ims<br>
ip pool name pool_apn1<br>
default-bearer qci 5 arp pl 6 pci 1 pvi 1<br>
pdn-type ipv4v6<br>
ip dns ipv4 primary 8.8.8.8  secondary 8.8.4.4<br>
ip p-cscf 10.10.202.230<br>
mtu 1430</p>
<p>exit<br>
apn internet<br>
ip pool name pool_apn2<br>
default-bearer qci 9 arp pl 15 pci 0 pvi 1<br>
pdn-type ipv4v6<br>
ip dns ipv4 primary 8.8.8.8  secondary 8.8.4.4<br>
ip p-cscf 10.10.202.230<br>
mtu 1300</p>
<p>exit<br>
apn anritsu<br>
ip pool name pool_apn1<br>
default-bearer qci 5 arp pl 10 pci 1 pvi 1<br>
pdn-type ipv4v6<br>
ip dns ipv4 primary 8.8.8.8  secondary 8.8.4.4<br>
ip p-cscf 10.10.202.230<br>
mtu 1430</p>
<p>exit<br>
apn mec<br>
ip pool name pool_apn3<br>
default-bearer qci 9 arp pl 15 pci 0 pvi 1<br>
pdn-type ipv4v6<br>
ip dns ipv4 primary 8.8.8.8  secondary 8.8.4.4<br>
ip p-cscf 10.10.202.230<br>
mtu 1300</p>
<p>exit</p>
<p>gtpc<br>
interface name loopback 3<br>
exit<br>
pfcp<br>
interface name loopback 9<br>
exit<br>
identity<br>
plmn mcc 901 mnc 70<br>
exit<br>
up-selection-policy<br>
branching-trigger tai<br>
branching-rule-base lbo-rule<br>
exit<br>
exit<br>
lte-service sgw-c<br>
pfcp<br>
interface name loopback 8<br>
exit<br>
partition 1<br>
gtpc s4s11<br>
interface name loopback 1<br>
exit<br>
gtpc s5s8<br>
interface name loopback 2<br>
exit<br>
exit<br>
up-selection-policy<br>
reselection-trigger tai<br>
exit<br>
exit</p>
<p>db-server addr 127.0.0.1 port 6379<br>
dhcpmgr fingerprint profile</p>
<p>!end of configuration</p>
<pre><code>

&lt;br&gt;
## /etc/network/interfaces
Configuring eth0 in /etc/network/interfaces as below:
</code></pre>
<h1 id="this-file-describes-the-network-interfaces-available-on-your-system-1">This file describes the network interfaces available on your system</h1>
<h1 id="and-how-to-activate-them.-for-more-information-see-interfaces5.-1">and how to activate them. For more information, see interfaces(5).</h1>
<h1 id="the-loopback-network-interface-1">The loopback network interface</h1>
<p>auto lo<br>
iface lo inet loopback</p>
<p>auto eth0<br>
iface eth0 inet static<br>
address 192.168.122.3<br>
netmask 255.255.255.0<br>
dns-nameservers 8.8.8.8</p>
<pre><code>
&lt;br&gt;
## reboot
reboot the VM:
</code></pre>
<p>reboot</p>
<pre><code>

&lt;br&gt;
# Setup SAEGW-U 
The SAEGW-u VM will auto start once installation finish, and you need to stop casa-mobile service once you can access VM's console.
</code></pre>
<p>stop casa-mobile</p>
<pre><code>
&lt;br&gt;
## cpu.conf
Creating /etc/virtcasa.d/cpu.conf:
</code></pre>

    
        
        
         
        
        
        
        
    

```
<br>
## hugepages
Configuring /etc/default/casa, HUGEPAGES here need to be changed to 4096.
```
...
# Number of 2-MB hugepages to reserve
HUGEPAGES=4096
...
```
<br>
## startup-config
Creating /fdsk/startup-config, below is an example configuration, you need to change the gige 0/1 IP to your SAEGW-U service port IP.
```
!User account/session configuration
!
! CASA-MOBILE system running configuration 
!
!casa logging control configuration:
!
!syslog servers for non-DOCSIS events:
<p>hostname “Casa-SAEGW-U”</p>
<p>password encrypted R7VgbZPass.y4yDukYdA8/</p>
<p>vrf definition pgw-gtpu<br>
!<br>
aaa authentication login local<br>
aaa accounting default group tacacsplus</p>
<p>interface gige 0/0<br>
auto negotiate<br>
no shutdown</p>
<p>interface gige 0/1<br>
ip address 192.168.97.22  255.255.255.0<br>
auto negotiate<br>
no shutdown</p>
<p>interface gige 0/2<br>
auto negotiate<br>
no shutdown</p>
<p>interface gige 0/3<br>
auto negotiate<br>
shutdown</p>
<p>interface loopback 1<br>
description “S4S11-interface NOT USED”<br>
ip address 31.31.31.1 255.255.255.255</p>
<p>interface loopback 2<br>
description “S5S8-interface SGW-U to PGW-U”<br>
ip address 31.31.31.2 255.255.255.255</p>
<p>interface loopback 3<br>
description “s5s8-interface PGW-U to SGW-U”<br>
ip address 31.31.31.3 255.255.255.255</p>
<p>interface loopback 8<br>
description “Sxa-interface SGW-U to SAEGW-C”<br>
ip address 32.32.32.1 255.255.255.255</p>
<p>interface loopback 9<br>
description “Sxb-interface PGW-U to SAEGW-C”<br>
ip address 32.32.32.2 255.255.255.255</p>
<p>interface loopback 12<br>
description “S1-U-interface SAEGW-U to SeGW/eNB”<br>
ip address 34.34.34.1 255.255.255.255</p>
<p>license<br>
exit</p>
<p>! static arp</p>
<p>ip route 0.0.0.0/0 192.168.97.19 1<br>
ip route 20.60.0.0/16 192.168.97.252 1<br>
ip route 22.22.23.1/32 192.168.97.21 1<br>
ip route 22.22.23.2/32 192.168.97.21 1<br>
!<br>
!snmp agent configuration<br>
!<br>
!DNS service configuration<br>
!</p>
<p>!DPI service configuration</p>
<p>nms-agent</p>
<p>!NSF service configuration<br>
lte-service pgw-u<br>
ip pool pool_apn2 type ipv4  60.10.5.0/24 public index 10</p>
<p>usage-type 2</p>
<p>gtpu<br>
interface name loopback 3<br>
exit<br>
pfcp<br>
interface name loopback 9<br>
peer ip-addr 22.22.23.2<br>
exit<br>
exit<br>
lte-service sgw-u<br>
gtpu s1-u<br>
interface name gige 0/1<br>
exit<br>
gtpu s5s8<br>
interface name loopback 2<br>
exit<br>
pfcp<br>
interface name loopback 8<br>
peer ip-addr 22.22.23.1<br>
exit<br>
usage-type 2<br>
exit</p>
<p>db-server addr 10.10.202.141 port 6379<br>
dhcpmgr fingerprint profile</p>
<p>!end of configuration</p>
<pre><code>
&lt;br&gt;
## /etc/network/interfaces
Configuring eth0 in /etc/network/interfaces as below:
</code></pre>
<h1 id="this-file-describes-the-network-interfaces-available-on-your-system-2">This file describes the network interfaces available on your system</h1>
<h1 id="and-how-to-activate-them.-for-more-information-see-interfaces5.-2">and how to activate them. For more information, see interfaces(5).</h1>
<h1 id="the-loopback-network-interface-2">The loopback network interface</h1>
<p>auto lo<br>
iface lo inet loopback</p>
<p>auto eth0<br>
iface eth0 inet static<br>
address 192.168.122.4<br>
netmask 255.255.255.0<br>
dns-nameservers 8.8.8.8</p>
<pre><code>
&lt;br&gt;
## reboot
reboot the VM:
</code></pre>
<p>reboot</p>
<pre><code>
&lt;br&gt;
# Setup HSS 

## /etc/network/interfaces
Configuring eth0 in /etc/network/interfaces as below:
</code></pre>
<h1 id="this-file-describes-the-network-interfaces-available-on-your-system-3">This file describes the network interfaces available on your system</h1>
<h1 id="and-how-to-activate-them.-for-more-information-see-interfaces5.-3">and how to activate them. For more information, see interfaces(5).</h1>
<h1 id="the-loopback-network-interface-3">The loopback network interface</h1>
<p>auto lo<br>
iface lo inet loopback</p>
<p>auto eth0<br>
iface eth0 inet static<br>
address 192.168.122.5<br>
netmask 255.255.255.0<br>
dns-nameservers 8.8.8.8</p>
<pre><code>
&lt;br&gt;
## installing/running openssh
Copy openssh to /opt/FHoSS.zip and run below command:
</code></pre>
<p>apt-get update<br>
apt-get install -y unzip<br>
cd /opt<br>
unzip FHoSS.zip<br>
cd FHoSS/deploy<br>
./startup.sh</p>
<pre><code>
If you need to change it's configuration, you can edit /opt/FHoSS/deploy/DiameterPeerHSS.xml or /opt/FHoSS/deploy/hss.properties to match your environment.



</code></pre>

